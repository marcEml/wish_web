{# templates/admin/ItemRank.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Top-3 Items for a Chosen Wishlist{% endblock %}

{% block body %}
<nav class="admin-menu">
    <div class="dropdown">
        <button class="dropbtn">
            Administration
            <span class="triangle">▲</span>
        </button>
        <div class="dropdown-content">
            <!-- 愿望清单总榜 -->
            <a href="{{ path('top3_wishlists') }}">
                The Top-3 Wishlists by Total Value
            </a>
            <!-- 本页面：单个清单内商品排行榜 -->
            <a href="{{ path('top3_items') }}">
                The Top-3 Most Expensive Items (choose a Wishlist)
            </a>
        </div>
    </div>
</nav>

<h1>Choose a Wishlist to see its Top-3 most expensive items</h1>

<!-- 下拉菜单表单，使用 GET 提交 -->
<form method="get" action="{{ path('top3_items') }}">
    <label for="wishlistId">Select a wishlist:</label>
    <select name="wishlistId" id="wishlistId" onchange="this.form.submit()">
        <option value="">-- Please choose --</option>
        {% for w in wishlists %}
            <option value="{{ w.id }}"
                {% if selectedWishlist and w.id == selectedWishlist.id %} selected {% endif %}
            >
                {{ w.name }}
            </option>
        {% endfor %}
    </select>
</form>

{% if selectedWishlist %}
    <h2>Top-3 Items for "{{ selectedWishlist.name }}"</h2>
    <div class="top-items">
        {% if topItems is not empty %}
            {% for item in topItems %}
                <div class="top-item">
                    <div class="top-item-image">
                        {% if item.externalLink %}
                            <img src="{{ asset(item.externalLink) }}" 
                                 alt="{{ item.name }}" 
                                 style="max-width: 100%; max-height: 100%;" />
                        {% else %}
                            <img src="{{ asset('images/placeholder.png') }}"
                                 alt="No image"
                                 style="max-width: 100%; max-height: 100%;" />
                        {% endif %}
                    </div>
                    <div class="top-item-label">
                        {{ item.name }}: {{ item.price }}€
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>No items found or no items in this wishlist.</p>
        {% endif %}
    </div>
{% else %}
    <p>Please select a wishlist above to see its top items.</p>
{% endif %}


<style>
    /* 这里可直接复用你已有的样式 */
    .admin-menu {
        margin-bottom: 1rem; 
    }
    .dropdown {
        position: relative;
        display: inline-block;
    }
    .dropbtn {
        background-color: #0088cc; 
        color: #fff;
        padding: 8px 16px;
        font-size: 16px;
        border: none;
        cursor: pointer;
        outline: none;
    }
    .triangle {
        font-size: 12px;
        margin-left: 8px;
    }
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #fff;
        min-width: 250px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        z-index: 999;
    }
    .dropdown-content a {
        display: block;
        color: #333;
        padding: 12px 16px;
        text-decoration: none;
    }
    .dropdown-content a:hover {
        background-color: #f1f1f1;
    }
    .dropdown:hover .dropdown-content {
        display: block;
    }
    .dropdown:hover .dropbtn {
        background-color: #006699;
    }

    .top-items {
        display: flex;
        justify-content: space-around;
        margin-top: 2rem;
    }
    .top-item {
        display: flex;
        flex-direction: column;
        width: 150px;
        text-align: center;
        border: 1px solid #ccc;
        margin: 0 0.5rem;
    }
    .top-item-image {
        background-color: #ccc;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .top-item-label {
        background-color: #8DC63F;
        color: #fff;
        font-weight: bold;
        padding: 1rem;
        margin-top: -1px;
    }
</style>

{% endblock %}
